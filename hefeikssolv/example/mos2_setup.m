%
% construct MoS2
%
kssolvpptype('pz-hgh', 'UPF');
%
% 1. construct atoms
%
a1 = Atom('S');
a2 = Atom('Mo');
atomlist = [ ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2 ...
];
%
% 2. set up supercell
%
C = [18.056333 0 0; 0 20.851238 0; 0 0 28.345891];
%
% 3. define the coordinates the atoms 
%
coefs = [
     0.166669995         0.083130002         0.397819996
     0.166669995         0.083130002         0.602180004
     0.166669995         0.583130002         0.397819996
     0.166669995         0.583130002         0.602180004
     0.833329976         0.083130002         0.397819996
     0.833329976         0.083130002         0.602180004
     0.833329976         0.583130002         0.397819996
     0.833329976         0.583130002         0.602180004
     0.500000000         0.083130002         0.397819996
     0.500000000         0.083130002         0.602180004
     0.500000000         0.583130002         0.397819996
     0.500000000         0.583130002         0.602180004
     0.000000000         0.333130002         0.397819996
     0.000000000         0.333130002         0.602180004
     0.000000000         0.833130002         0.397819996
     0.000000000         0.833130002         0.602180004
     0.666670024         0.333130002         0.397819996
     0.666670024         0.333130002         0.602180004
     0.666670024         0.833130002         0.397819996
     0.666670024         0.833130002         0.602180004
     0.333330005         0.333130002         0.397819996
     0.333330005         0.333130002         0.602180004
     0.333330005         0.833130002         0.397819996
     0.333330005         0.833130002         0.602180004
     0.000000000         0.000400000         0.500000000
     0.000000000         0.500400007         0.500000000
     0.666670024         0.000400000         0.500000000
     0.666670024         0.500400007         0.500000000
     0.333330005         0.000400000         0.500000000
     0.333330005         0.500400007         0.500000000
     0.166669995         0.250400007         0.500000000
     0.166669995         0.750400007         0.500000000
     0.833329976         0.250400007         0.500000000
     0.833329976         0.750400007         0.500000000
     0.500000000         0.250400007         0.500000000
     0.500000000         0.750400007         0.500000000
];
xyzlist = coefs*C';
%
% 4. Configure the molecule (crystal)
%
mol = Molecule('supercell',C, 'atomlist',atomlist, 'xyzlist' ,xyzlist, ...
    'ecut',30, 'name','MoS2' );
