%
% construct MoS2
%
kssolvpptype('pz-hgh', 'UPF');
%
% 1. construct atoms
%
a1 = Atom('S');
a2 = Atom('Mo');
atomlist = [ ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2, a2, a2, a2, a2, a2, a2 ...
];
%
% 2. set up supercell
%
C = [18.056340 0 0; 0 31.276870 0; 0 0 37.794537];
%
% 3. define the coordinates the atoms 
%
coefs = [
  0.1666673151178111  0.0553943041134461  0.4234423134649195
  0.1666673151178111  0.0553943041134461  0.5765576865350805
  0.5000000000000000  0.0553944941298734  0.4234427245516073
  0.5000000000000000  0.0553944941298734  0.5765572754483929
  0.8333326558821900  0.0553943041134461  0.4234423134649195
  0.8333326558821900  0.0553943041134461  0.5765576865350805
  0.1666673936313244  0.3887264481128286  0.4234429687305732
  0.1666673936313244  0.3887264481128286  0.5765570312694267
  0.5000000000000000  0.3887264885636176  0.4234433192555528
  0.5000000000000000  0.3887264885636176  0.5765566807444472
  0.8333325773686768  0.3887264481128286  0.4234429687305733
  0.8333325773686768  0.3887264481128286  0.5765570312694267
  0.1666671369433527  0.7220597030817371  0.4234420641416973
  0.1666671369433527  0.7220597030817371  0.5765579358583027
  0.5000000000000000  0.7220598058633930  0.4234422419678622
  0.5000000000000000  0.7220598058633930  0.5765577580321377
  0.8333328340566486  0.7220597030817371  0.4234420641416973
  0.8333328340566486  0.7220597030817371  0.5765579358583027
  0.0000000000000000  0.2220598058633930  0.4234422419678622
  0.0000000000000000  0.2220598058633930  0.5765577580321377
  0.3333328630566473  0.2220597030817371  0.4234420641416973
  0.3333328630566473  0.2220597030817371  0.5765579358583027
  0.6666671659433514  0.2220597030817371  0.4234420641416973
  0.6666671659433514  0.2220597030817371  0.5765579358583027
  0.0000000000000000  0.5553944871298765  0.4234427245516073
  0.0000000000000000  0.5553944871298765  0.5765572754483929
  0.3333326848821889  0.5553942971134491  0.4234423134649195
  0.3333326848821889  0.5553942971134491  0.5765576865350805
  0.6666673441178100  0.5553942971134491  0.4234423134649195
  0.6666673441178100  0.5553942971134491  0.5765576865350805
  0.0000000000000000  0.8887265185636128  0.4234433192555528
  0.0000000000000000  0.8887265185636128  0.5765566807444472
  0.3333326063686756  0.8887264781128240  0.4234429687305732
  0.3333326063686756  0.8887264781128240  0.5765570312694267
  0.6666674226313232  0.8887264781128240  0.4234429687305732
  0.6666674226313232  0.8887264781128240  0.5765570312694267
  0.0000000000000000  0.0003269320351678  0.5000000000000000
  0.1666671222942086  0.1669932495478198  0.5000000000000000
  0.3333331998698958  0.0003265557548579  0.5000000000000000
  0.5000000000000000  0.1669938029445834  0.5000000000000000
  0.6666668291301030  0.0003265557548579  0.5000000000000000
  0.8333328487057926  0.1669932495478198  0.5000000000000000
  0.0000000000000000  0.3336591766991246  0.5000000000000000
  0.1666668001301042  0.5003265557548580  0.5000000000000000
  0.3333333002239939  0.3336585456849874  0.5000000000000000
  0.5000000000000000  0.5003269320351679  0.5000000000000000
  0.6666667287760047  0.3336585456849874  0.5000000000000000
  0.8333331708698970  0.5003265557548580  0.5000000000000000
  0.0000000000000000  0.6669938319445823  0.5000000000000000
  0.1666666997760060  0.8336585166849885  0.5000000000000000
  0.3333328777057914  0.6669932785478186  0.5000000000000000
  0.5000000000000000  0.8336591476991260  0.5000000000000000
  0.6666671512942074  0.6669932785478186  0.5000000000000000
  0.8333332712239953  0.8336585166849885  0.5000000000000000
];
xyzlist = coefs*C';
%
% 4. Configure the molecule (crystal)
%
mol = Molecule('supercell',C, 'atomlist',atomlist, 'xyzlist' ,xyzlist, ...
    'ecut',20, 'name','MoS2' );
