%
%  construct bulk Silicon (crystal)
%
kssolvpptype('pz-vbc')

%  1. construct atoms
a1 = Atom('Si');
atomlist = [a1 a1 a1 a1 a1 a1 a1 a1];

%  2. set up the primitive cell
C = 10.2625*eye(3);

%  3. define the coordinates the atoms
xyzlist = [
    0.000000000         0.000000000         0.000000000
    0.000000000         0.500000000         0.500000000
    0.500000000         0.000000000         0.500000000
    0.500000000         0.500000000         0.000000000
    0.750000000         0.250000000         0.750000000
    0.250000000         0.250000000         0.250000000
    0.250000000         0.750000000         0.750000000
    0.750000000         0.750000000         0.250000000
    ]*C;

autokpts = [ 4 4 4 0 0 0 ];

kpts = [
    0.0000000   0.0000000   0.0000000
    0.0000000   0.0000000   0.2500000
	0.0000000   0.0000000  -0.5000000
	0.0000000   0.2500000   0.2500000
	0.0000000   0.2500000  -0.5000000
	0.0000000  -0.5000000  -0.5000000
	0.2500000   0.2500000   0.2500000
	0.2500000   0.2500000  -0.5000000
	0.2500000  -0.5000000  -0.5000000
	-0.5000000  -0.5000000  -0.5000000
	-0.2500000   0.0000000   0.2500000
	0.2500000  -0.2500000   0.2500000
	0.2500000  -0.2500000  -0.5000000];

wks = [
    0.0312500
    0.1875000
    0.0937500
    0.1875000
    0.3750000
    0.0937500
    0.0625000
    0.1875000
    0.1875000
    0.0312500
    0.1875000
    0.1875000
    0.1875000];
wks = wks/sumel(wks);

% 4. Configure the molecule (crystal)
cry = Crystal('supercell',C, 'atomlist',atomlist, 'xyzlist' ,xyzlist, ...
    'ecut',12.5, 'name','Silicon', 'autokpts', autokpts );%'kpts',kpts, 'wks',wks );

opt = setksopt;
opt.verbose = 'off';
opt.maxscfiter = 10;

% QE ref: Etot = -63.48018027
[cry,H,X,info] = scf(cry,opt);
