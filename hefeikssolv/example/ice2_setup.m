%
% construct Ice
%
kssolvpptype('pz-hgh', 'UPF');
%
% 1. construct atoms
%
a1 = Atom('H');
a2 = Atom('O');
atomlist = [ ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, a1, a1, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2 ...
];
%
% 2. set up supercell
%
C = [18.056340 0 0; 0 31.276870 0; 0 0 37.794537];
%
% 3. define the coordinates the atoms 
%
coefs = [
  0.7395453845540233  0.1901163569034151  0.7438192185359449
  0.6556477161311706  0.2750347838675185  0.7434184988852804
  0.8945123139895358  0.2975866323424832  0.7470452543410662
  0.9939486172026036  0.3318111308542943  0.8031076502003675
  0.2395483666874225  0.1901385701879950  0.7438092221535668
  0.1556963455831366  0.2750662310638045  0.7433934615434071
  0.3947980629226395  0.2975571181172323  0.7470124550207083
  0.4941721848550550  0.3318112778702253  0.8030926235720113
  0.4867501115080209  0.9396062764845512  0.7425686175408418
  0.4005772196151864  0.0241652869770896  0.7433930768814437
  0.6394998408829486  0.0476769590918996  0.7477406995146927
  0.7390210234974866  0.0804317804983957  0.8044514105214674
  0.9867026436179266  0.9396496577959790  0.7426119797386351
  0.9005685160796201  0.0242066496756347  0.7434132561098781
  0.1395300841040130  0.0476855318434313  0.7477459774020185
  0.2390870253386084  0.0804434280988536  0.8044484791783395
  0.4867027986907911  0.4395359615142822  0.7425591027118423
  0.4005128060871710  0.5240890352811288  0.7434017932738954
  0.6394785279795203  0.5476740815647312  0.7477310367005507
  0.7389263101262676  0.5804571026504249  0.8044506609282430
  0.9866341069029073  0.4395844545472731  0.7426085492988039
  0.9005192693067976  0.5241458537007947  0.7434276482623601
  0.7394923623955272  0.6900959514591642  0.7438406935820265
  0.6556320765397818  0.7750512124433580  0.7434210641239679
  0.8945700001020626  0.7975612393857072  0.7470449025046303
  0.9939647610792002  0.8318344447640338  0.8031076120828264
  0.2395122196569709  0.6901369916607907  0.7438338000769921
  0.1556766814435445  0.7750697763304570  0.7434121817527235
  0.3947799632567260  0.7975611792897326  0.7470329393352804
  0.4941166822615638  0.8318289229543098  0.8030965020768877
  0.9991342949003303  0.9403152139146993  0.2579438828034084
  0.0842315575079614  0.0251314888882344  0.2589312738932020
  0.8447862509401152  0.0478096981108212  0.2537437475044767
  0.7449664424406868  0.0801526782002222  0.1969602514517640
  0.4990382877762519  0.9399767099603761  0.2577690526690324
  0.5837781970116185  0.0247304969660117  0.2578044669136280
  0.3442090874768161  0.0480282708526549  0.2549751094761002
  0.2444676455524382  0.0823583067793260  0.1990601643009940
  0.7484510028108352  0.1881243642674301  0.2574514097781259
  0.8329890195128087  0.2731470450105280  0.2575483836475713
  0.5956273963135237  0.2969877881383382  0.2532879878898245
  0.4966853922982446  0.3306785178104336  0.1967359677112499
  0.2497783344511927  0.1904715040450855  0.2599284860339279
  0.3351517476593787  0.2751882550842136  0.2583822691240401
  0.0962734584638768  0.2979412595912905  0.2539627762458532
 -0.0025566215679812  0.3300222551154282  0.1967363145399455
  0.4990399531456781  0.4402527910192339  0.2565963781048203
  0.5834896667080501  0.5250957288415086  0.2560809237964623
  0.3437211446831270  0.5476725278468170  0.2520729500071502
  0.2441552555261238  0.5809532666856901  0.1956199948586064
  0.9981099838827209  0.4393268025237656  0.2566031883855229
  0.0825449118405149  0.5242566893286603  0.2562347221088256
  0.7481053177946301  0.6878892881451308  0.2569185839292273
  0.8321059213740003  0.7731420237568148  0.2569220855180015
  0.5950010826438306  0.7966859621073962  0.2530123860359618
  0.4965469179809446  0.8313181739964188  0.1966760029383412
  0.2468672814239583  0.6885743620885694  0.2568855027135081
  0.3315332384396865  0.7734118106366544  0.2570418691543540
  0.0931600260205888  0.7976371938684080  0.2528867867357054
 -0.0054052807661081  0.8318764899486097  0.1964426522562150
  0.1394535619695109  0.5476866237514076  0.7477550190121331
  0.2389346094631389  0.5804584476502206  0.8044682927167699
  0.8437580552678156  0.5472678320732617  0.2524141684355663
  0.7449571893723822  0.5808978467314877  0.1958168489406062
  0.7494263773563991  0.2496539318472549  0.7499812235302297
  0.9868755861612362  0.3284549963529779  0.7544831153086976
  0.2494669312303234  0.2496791651608435  0.7499791314561570
  0.4871604547470699  0.3284191591790879  0.7544671232130647
  0.4947951245705033 -0.0008310438408144  0.7493222678068820
  0.7319750612015766  0.0781593258247699  0.7557982247940529
 -0.0052270758886413 -0.0007903407625909  0.7493640033413574
  0.2320168565836173  0.0781756318885621  0.7558011500432001
  0.4947399450351349  0.4990924540394358  0.7492463142210966
  0.7319862787825759  0.5781553763661055  0.7558032203051348
 -0.0052585741184373  0.4991545397634271  0.7492960316541215
  0.7494115458619319  0.7496457229219481  0.7499556307001268
  0.9869579409852808  0.8284277422224213  0.7544807824761680
  0.2494506428327340  0.7496725241772151  0.7499747714668789
  0.4871565022094368  0.8284240854770517  0.7544680510392126
  0.9902666290312665 -0.0000052974483044  0.2524003043404466
  0.7520382274294565  0.0781218463571258  0.2456334780303734
  0.4896687977565103 -0.0004153792797908  0.2518242229138529
  0.2517750985112339  0.0788409914032090  0.2476564602947002
  0.7390974436823211  0.2478306041977903  0.2517321460749724
  0.5037850948143859  0.3282559318706816  0.2454010008806319
  0.2407720522021133  0.2500025675262944  0.2534980235469875
  0.0037397954522250  0.3282317213200379  0.2454379264062498
  0.4895506725050765  0.4997450816127141  0.2500042182142682
  0.2510616599750454  0.5780860551965952  0.2442675247743530
  0.9886213040047188  0.4989244318299051  0.2503251335308095
  0.7384293719720925  0.7475478943839773  0.2511221722135669
  0.5033979706332610  0.8281519228733256  0.2453046889148214
  0.2374828280704407  0.7482685955536152  0.2513697380873459
  0.0014512501928145  0.8288999792530841  0.2450842732220765
  0.2319854369240628  0.5781392344511551  0.7558046620175447
  0.7514786285752851  0.5781191273267258  0.2444931886989669
];
xyzlist = coefs*C';
%
% 4. Configure the molecule (crystal)
%
mol = Molecule('supercell',C, 'atomlist',atomlist, 'xyzlist' ,xyzlist, ...
    'ecut',20, 'name','Ice' );
