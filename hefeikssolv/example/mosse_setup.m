%
% construct MoS2
%
kssolvpptype('pz-hgh', 'UPF');
%
% 1. construct atoms
%
a1 = Atom('S');
a2 = Atom('Se');
a3 = Atom('Mo');
atomlist = [ ...
a1, a1, a1, a1, a1, a1, a1, a1, a1, a1, ...
a1, a1, ...
a2, a2, a2, a2, a2, a2, a2, a2, a2, a2, ...
a2, a2, ...
a3, a3, a3, a3, a3, a3, a3, a3, a3, a3, ...
a3, a3 ...
];
%
% 2. set up supercell
%
C = [18.407821 0 0; 0 21.255639 0; 0 0 28.345891];
%
% 3. define the coordinates the atoms 
%
coefs = [
     0.166669995         0.083039999         0.599399984
     0.000000000         0.333039999         0.599399984
     0.500000000         0.083039999         0.599399984
     0.333330005         0.333039999         0.599399984
     0.833329976         0.083039999         0.599399984
     0.666670024         0.333039999         0.599399984
     0.166669995         0.583039999         0.599399984
     0.000000000         0.833039999         0.599399984
     0.500000000         0.583039999         0.599399984
     0.333330005         0.833039999         0.599399984
     0.833329976         0.583039999         0.599399984
     0.666670024         0.833039999         0.599399984
     0.166669995         0.083219998         0.388260007
     0.000000000         0.333229989         0.388260007
     0.500000000         0.083219998         0.388260007
     0.333330005         0.333229989         0.388260007
     0.833329976         0.083219998         0.388260007
     0.666670024         0.333229989         0.388260007
     0.166669995         0.583230019         0.388260007
     0.000000000         0.833230019         0.388260007
     0.500000000         0.583230019         0.388260007
     0.333330005         0.833230019         0.388260007
     0.833329976         0.583230019         0.388260007
     0.666670024         0.833230019         0.388260007
     0.000000000         0.000390000         0.499509990
     0.166669995         0.250389993         0.499509990
     0.333330005         0.000390000         0.499509990
     0.500000000         0.250389993         0.499509990
     0.666670024         0.000390000         0.499509990
     0.833329976         0.250389993         0.499509990
     0.000000000         0.500389993         0.499509990
     0.166669995         0.750389993         0.499509990
     0.333330005         0.500389993         0.499509990
     0.500000000         0.750389993         0.499509990
     0.666670024         0.500389993         0.499509990
     0.833329976         0.750389993         0.499509990
];
xyzlist = coefs*C';
%
% 4. Configure the molecule (crystal)
%
mol = Molecule('supercell',C, 'atomlist',atomlist, 'xyzlist' ,xyzlist, ...
    'ecut',30, 'name','MoS2' );
